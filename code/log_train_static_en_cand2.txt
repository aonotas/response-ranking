
Namespace(activation='tanh', attention=0, batch=32, data_size=10000000, dev_data='/cl/work/motoki-s/multi_ling_conversation/data/2015_concat/2015_cand2_lang_en_dev.txt', dim_emb=50, dim_hidden=50, epoch=30, init_emb=None, load_model=None, load_words=None, loss='nll', lr=0.001, max_n_words=20, mode='train', model='static', n_cands=2, n_prev_sents=5, opt='adam', output=0, output_fn=None, reg=0.0001, sample_size=1, save=1, test_data='/cl/work/motoki-s/multi_ling_conversation/data/2015_concat/2015_cand2_lang_en_test.txt', train_data='/cl/work/motoki-s/multi_ling_conversation/data/2015_concat/2015_cand2_lang_en_train.txt', unit='gru')


ADDRESSEE AND RESPONSE SELECTION SYSTEM START

SET UP DATASET

Load dataset...
Load initial word embedding...
	Random Initialized Word Embeddings6606
2728
6


TASK  SETTING
	Response Candidates:2  Contexts:5  Max Word Num:20


Converting words into ids...
	Questions:   751108
	Questions:    39809
	Questions:    45776

Creating samples...
	THREADS:  6606
	  SAMPLES:   636547
	  ADDRESSEE DETECTION CHANCE LEVEL:   1.50%
	  ADDRESSEE DETECTION UPPER BOUND:
		# Cands  1:   0.00% | Total:        0 | Including true-adr:        0 | Not including:        0
		# Cands  2: 100.00% | Total:   157527 | Including true-adr:   157527 | Not including:        0
		# Cands  3: 100.00% | Total:   220381 | Including true-adr:   220381 | Not including:        0
		# Cands  4: 100.00% | Total:   172959 | Including true-adr:   172959 | Not including:        0
		# Cands  5: 100.00% | Total:    72895 | Including true-adr:    72895 | Not including:        0
		# Cands  6: 100.00% | Total:    12785 | Including true-adr:    12785 | Not including:        0

	  THE BINNED NUMBER OF AGENTS IN CONTEXT:
		Bin  0:    52584
		Bin  1:    90113
		Bin  2:    84726
		Bin  3:    68841
		Bin  4:    72401
		Bin  5:    90504
		Bin  6:   177378

	THREADS:   367
	  SAMPLES:    38661
	  ADDRESSEE DETECTION CHANCE LEVEL:   1.59%
	  ADDRESSEE DETECTION UPPER BOUND:
		# Cands  1:   0.00% | Total:      119 | Including true-adr:        0 | Not including:      119
		# Cands  2:  92.27% | Total:     9698 | Including true-adr:     8948 | Not including:      750
		# Cands  3:  87.68% | Total:    13337 | Including true-adr:    11694 | Not including:     1643
		# Cands  4:  86.75% | Total:    10341 | Including true-adr:     8971 | Not including:     1370
		# Cands  5:  85.26% | Total:     4382 | Including true-adr:     3736 | Not including:      646
		# Cands  6:  85.84% | Total:      784 | Including true-adr:      673 | Not including:      111

	  THE BINNED NUMBER OF AGENTS IN CONTEXT:
		Bin  0:     3092
		Bin  1:     5358
		Bin  2:     5842
		Bin  3:     4048
		Bin  4:     4686
		Bin  5:     5969
		Bin  6:     9666

	THREADS:   382
	  SAMPLES:    44714
	  ADDRESSEE DETECTION CHANCE LEVEL:   1.23%
	  ADDRESSEE DETECTION UPPER BOUND:
		# Cands  1:   0.00% | Total:      147 | Including true-adr:        0 | Not including:      147
		# Cands  2:  92.04% | Total:     9593 | Including true-adr:     8829 | Not including:      764
		# Cands  3:  87.66% | Total:    14982 | Including true-adr:    13133 | Not including:     1849
		# Cands  4:  86.13% | Total:    12946 | Including true-adr:    11150 | Not including:     1796
		# Cands  5:  83.88% | Total:     5899 | Including true-adr:     4948 | Not including:      951
		# Cands  6:  84.74% | Total:     1147 | Including true-adr:      972 | Not including:      175

	  THE BINNED NUMBER OF AGENTS IN CONTEXT:
		Bin  0:     3115
		Bin  1:     5387
		Bin  2:     5137
		Bin  3:     4361
		Bin  4:     4455
		Bin  5:     5919
		Bin  6:    16340


TRAIN SETTING	Batch Size:32  Epoch:30  Vocab:498122  Max Words:20

Train samples	Mini-Batch:19888
Dev samples	Mini-Batch:1216
Test samples	Mini-Batch:1405

BUILD A MODEL
MODEL: static  Unit: gru  Opt: adam  Activation: tanh  Parameters: 24931350


TRAINING START



Epoch: 1
  TRAIN    100/19888  200/19888  300/19888  400/19888  500/19888  600/19888  700/19888  800/19888  900/19888  1000/19888  1100/19888  1200/19888  1300/19888  1400/19888  1500/19888  1600/19888  1700/19888  1800/19888  1900/19888  2000/19888  2100/19888  2200/19888  2300/19888  2400/19888  2500/19888  2600/19888  2700/19888  2800/19888  2900/19888  3000/19888  3100/19888  3200/19888  3300/19888  3400/19888  3500/19888  3600/19888  3700/19888  3800/19888  3900/19888  4000/19888  4100/19888  4200/19888  4300/19888  4400/19888  4500/19888  4600/19888  4700/19888  4800/19888  4900/19888  5000/19888  5100/19888  5200/19888  5300/19888  5400/19888  5500/19888  5600/19888  5700/19888  5800/19888  5900/19888  6000/19888  6100/19888  6200/19888  6300/19888  6400/19888  6500/19888  6600/19888  6700/19888  6800/19888  6900/19888  7000/19888  7100/19888  7200/19888  7300/19888  7400/19888  7500/19888  7600/19888  7700/19888  7800/19888  7900/19888  8000/19888  8100/19888  8200/19888  8300/19888  8400/19888  8500/19888  8600/19888  8700/19888  8800/19888  8900/19888  9000/19888  9100/19888  9200/19888  9300/19888  9400/19888  9500/19888  9600/19888  9700/19888  9800/19888  9900/19888  10000/19888  10100/19888  10200/19888  10300/19888  10400/19888  10500/19888  10600/19888  10700/19888  10800/19888  10900/19888  11000/19888  11100/19888  11200/19888  11300/19888  11400/19888  11500/19888  11600/19888  11700/19888  11800/19888  11900/19888  12000/19888  12100/19888  12200/19888  12300/19888  12400/19888  12500/19888  12600/19888  12700/19888  12800/19888  12900/19888  13000/19888  13100/19888  13200/19888  13300/19888  13400/19888  13500/19888  13600/19888  13700/19888  13800/19888  13900/19888  14000/19888  14100/19888  14200/19888  14300/19888  14400/19888  14500/19888  14600/19888  14700/19888  14800/19888  14900/19888  15000/19888  15100/19888  15200/19888  15300/19888  15400/19888  15500/19888  15600/19888  15700/19888  15800/19888  15900/19888  16000/19888  16100/19888  16200/19888  16300/19888  16400/19888  16500/19888  16600/19888  16700/19888  16800/19888  16900/19888  17000/19888  17100/19888  17200/19888  17300/19888  17400/19888  17500/19888  17600/19888  17700/19888  17800/19888  17900/19888  18000/19888  18100/19888  18200/19888  18300/19888  18400/19888  18500/19888  18600/19888  18700/19888  18800/19888  18900/19888  19000/19888  19100/19888  19200/19888  19300/19888  19400/19888  19500/19888  19600/19888  19700/19888  19800/19888
	Time: 44076.247319
	Total Loss: 721458.245008	Total Grad Norm: 199231.881045
	Avg.  Loss: 36.276058	Avg.  Grad Norm: 10.017693

	Accuracy
	TOTAL  Both:  43.53% ( 277046/ 636416)  Adr:  67.56% ( 429994/ 636416)  Res:  64.40% ( 409865/ 636416)

	    0  Both:  54.75% (  28788/  52580)  Adr:  87.37% (  45939/  52580)  Res:  62.52% (  32874/  52580)
	    1  Both:  49.83% (  44900/  90098)  Adr:  78.77% (  70972/  90098)  Res:  62.89% (  56664/  90098)
	    2  Both:  47.66% (  40376/  84714)  Adr:  75.61% (  64051/  84714)  Res:  62.88% (  53268/  84714)
	    3  Both:  47.41% (  32633/  68833)  Adr:  74.82% (  51504/  68833)  Res:  62.92% (  43311/  68833)
	    4  Both:  45.17% (  32697/  72394)  Adr:  71.36% (  51660/  72394)  Res:  63.05% (  45647/  72394)
	    5  Both:  40.60% (  36733/  90479)  Adr:  61.16% (  55336/  90479)  Res:  65.78% (  59518/  90479)
	    6  Both:  34.36% (  60919/ 177318)  Adr:  51.06% (  90532/ 177318)  Res:  66.88% ( 118583/ 177318)


  DEV    100/1216  200/1216  300/1216  400/1216  500/1216  600/1216  700/1216  800/1216  900/1216  1000/1216  1100/1216  1200/1216
	Time: 125.670722
	Total Loss: 0.000000	Total Grad Norm: 0.000000
	Avg.  Loss: 0.000000	Avg.  Grad Norm: 0.000000

	Accuracy
	TOTAL  Both:  41.36% (  15991/  38661)  Adr:  61.59% (  23811/  38661)  Res:  66.49% (  25706/  38661)

	    0  Both:  55.24% (   1708/   3092)  Adr:  85.77% (   2652/   3092)  Res:  64.75% (   2002/   3092)
	    1  Both:  49.10% (   2631/   5358)  Adr:  74.69% (   4002/   5358)  Res:  65.29% (   3498/   5358)
	    2  Both:  45.53% (   2660/   5842)  Adr:  68.32% (   3991/   5842)  Res:  65.34% (   3817/   5842)
	    3  Both:  43.21% (   1749/   4048)  Adr:  64.25% (   2601/   4048)  Res:  65.69% (   2659/   4048)
	    4  Both:  44.02% (   2063/   4686)  Adr:  64.81% (   3037/   4686)  Res:  66.47% (   3115/   4686)
	    5  Both:  35.87% (   2141/   5969)  Adr:  53.06% (   3167/   5969)  Res:  67.11% (   4006/   5969)
	    6  Both:  31.44% (   3039/   9666)  Adr:  45.12% (   4361/   9666)  Res:  68.37% (   6609/   9666)


  TEST    100/1405  200/1405  300/1405  400/1405  500/1405  600/1405  700/1405  800/1405  900/1405  1000/1405  1100/1405  1200/1405  1300/1405  1400/1405
	Time: 145.147422
	Total Loss: 0.000000	Total Grad Norm: 0.000000
	Avg.  Loss: 0.000000	Avg.  Grad Norm: 0.000000

	Accuracy
	TOTAL  Both:  39.12% (  17494/  44714)  Adr:  58.09% (  25975/  44714)  Res:  66.93% (  29925/  44714)

	    0  Both:  56.18% (   1750/   3115)  Adr:  85.20% (   2654/   3115)  Res:  65.84% (   2051/   3115)
	    1  Both:  47.63% (   2566/   5387)  Adr:  72.14% (   3886/   5387)  Res:  66.36% (   3575/   5387)
	    2  Both:  46.08% (   2367/   5137)  Adr:  68.66% (   3527/   5137)  Res:  65.97% (   3389/   5137)
	    3  Both:  43.64% (   1903/   4361)  Adr:  65.24% (   2845/   4361)  Res:  65.95% (   2876/   4361)
	    4  Both:  40.40% (   1800/   4455)  Adr:  61.08% (   2721/   4455)  Res:  64.92% (   2892/   4455)
	    5  Both:  37.42% (   2215/   5919)  Adr:  54.20% (   3208/   5919)  Res:  67.63% (   4003/   5919)
	    6  Both:  29.94% (   4893/  16340)  Adr:  43.66% (   7134/  16340)  Res:  68.17% (  11139/  16340)

	BEST ACCURACY HISTORY
	EPOCH-  1 | DEV  Both: 41.36%  Adr: 61.59%  Res: 66.49% | TEST  Both: 39.12%  Adr: 58.09%  Res: 66.93%


Epoch: 2
  TRAIN    100/19888  200/19888  300/19888  400/19888  500/19888  600/19888  700/19888  800/19888  900/19888  1000/19888  1100/19888  1200/19888  1300/19888  1400/19888  1500/19888  1600/19888  1700/19888  1800/19888  1900/19888  2000/19888  2100/19888  2200/19888  2300/19888  2400/19888  2500/19888  2600/19888  2700/19888  2800/19888  2900/19888  3000/19888  3100/19888  3200/19888  3300/19888  3400/19888  3500/19888  3600/19888  3700/19888  3800/19888  3900/19888  4000/19888  4100/19888  4200/19888  4300/19888  4400/19888  4500/19888  4600/19888  4700/19888  4800/19888  4900/19888  5000/19888  5100/19888  5200/19888  5300/19888  5400/19888  5500/19888  5600/19888  5700/19888  5800/19888  5900/19888  6000/19888  6100/19888  6200/19888  6300/19888  6400/19888  6500/19888  6600/19888  6700/19888  6800/19888  6900/19888  7000/19888  7100/19888  7200/19888  7300/19888  7400/19888  7500/19888  7600/19888  7700/19888  7800/19888  7900/19888  8000/19888  8100/19888  8200/19888  8300/19888  8400/19888  8500/19888  8600/19888  8700/19888  8800/19888  8900/19888  9000/19888  9100/19888  9200/19888  9300/19888  9400/19888  9500/19888  9600/19888  9700/19888  9800/19888  9900/19888  10000/19888  10100/19888  10200/19888  10300/19888  10400/19888  10500/19888  10600/19888  10700/19888  10800/19888  10900/19888  11000/19888